\chapter{连续型随机变量}

\section{连续型随机变量的概念}
本小节的主要内容为：
分布函数，连续型随机变量的概率密度与性质，连续型随机变量函数分布的求法，
二维连续型随机变量的概率密度、边缘密度和条件密度，
连续型随机变量的独立性，二维随机变量函数分布的求法。

\subsection{分布函数}
\begin{definition}[分布函数]
  设$X$是一个随机变量，$x$是任意实数，则函数
  \begin{displaymath}
    F(x)=P(X\le x)
  \end{displaymath}
  称为$X$的分布函数。
\end{definition}

\begin{remark}
  根据定义可以直接得到，对于任意实数$x_1,x_2\ (x_1<x_2)$，
  \begin{displaymath}
  P(x_1 < X \le x_2) = F(x_2) - F(x_1)
  \end{displaymath}
\end{remark}

\begin{remark}
  离散型随机变量和连续型随机变量都适用于分布函数的定义。
\end{remark}

\begin{theorem}[分布函数的性质]
  分布函数$F(x)=P(X\le x)$具有以下性质：
  \begin{enumerate}
    \item
    $F(x)$是单调非递减函数。
    \item
    $0\le F(x)\le 1$且
    $F(-\infty) = 0$，$F(+\infty) = 1$。
    \item
    $F(x)$是右连续的。
  \end{enumerate}
  反之，任一具有以上三性质的函数必是某随机变量的分布函数。
\end{theorem}

\subsection{连续型随机变量与概率密度}
\begin{definition}[连续型随机变量] \label{def-continuous-rv}
  设$X$为随机变量，$F(x)$为$X$的分布函数。
  若存在非负函数$p(x)$，使对于任意实数$x$有
  \begin{displaymath}
    F(x) = \mintcumto{x}p(t)dt
  \end{displaymath}
  则称$X$为\textbf{连续型随机变量}，
  其中$p(x)$称为$X$的\textbf{概率密度函数}，简称\textbf{密度函数}。
\end{definition}

\begin{theorem}[连续型随机变量$F(x)$与$p(x)$的性质]
  设$F(x)$和$p(x)$分别是连续型随机变量$X$的分布函数与密度函数，则
  \begin{enumerate}
    \item
    $p(x) \ge 0$
    \item
    $\mintall p(x)dx = 1$
    \item
    $F(x)$是连续函数。
    \item
    $P(x_1< X\le x_2)=\int_{x_1}^{x_2}p(x)dx$
    \item
    对任意$a\in\mfR$，$P(X=a)=0$。
    \item
    若$p(x)$在点$x$处连续，则有
    $F'(x)=p(x)$。
  \end{enumerate}
\end{theorem}

\subsection{连续型随机变量函数的分布} \label{subsec-con-rv-func-distribution}
设$X$是连续型随机变量，其密度函数为$p_X(x)$，
$y=g(x)$是关于$x$的连续函数，$Y=g(X)$是连续型随机变量。
下面给出求$Y=g(X)$的密度函数$p_Y(y)$的两种方法。

第一种方法是\textbf{分布函数法}。
我们首先求$Y$的分布函数
\begin{displaymath}
  F_Y(y) = P(Y \le y) = P(g(X) \le y) = \int_{x: g(x)\le y} p_X(x)dx
\end{displaymath}
然后对分布函数求导，得到$p_Y(y) = F'_Y(y)$。

第二种方法是直接使用定理：
设$X$的密度函数为
\begin{displaymath}
  p_X(x) = \begin{cases}
    > 0 & a < x < b \\
    0   & \text{其它}
  \end{cases}
\end{displaymath}
其中$a$可为$-\infty$，$b$可为$+\infty$。
若$y=g(x)$在$(a,b)$处处可导且单调，
则$Y=g(X)$也是连续型随机变量，其概率密度为
\begin{displaymath}
  p_Y(y)=\begin{cases}
    p_X(g^{-1}(y))\cdot |(g^{-1}(y))'| & \alpha < y < \beta \\
    0 & \text{其它}
  \end{cases}
\end{displaymath}
其中，$\alpha=\min\{g(a), g(b) \}, \beta=\max\{g(a),g(b)\}$。

\subsection{二维连续型随机变量}
\begin{definition}[联合分布函数]
  设$(X,Y)$是一个二维随机向量，则对于任意实数对$(x,y)$，
  \begin{displaymath}
    F(x,y) = P(X\le x, Y\le y)
  \end{displaymath}
  是$(x,y)$的函数，称为二维随机向量$(X,Y)$的\textbf{联合分布函数}。
\end{definition}

\begin{theorem}[联合分布函数的性质]
  联合分布函数$F(x,y)$具有以下性质：
  \begin{enumerate}
    \item
    $F(x,y)$分布对每个变量单调非减。
    \item
    $0\le F(x,y)\le 1$且
    \begin{gather*}
    F(-\infty,y)=F(x,-\infty) = 0 \\
    F(-\infty,-\infty)=0,\ F(+\infty,+\infty)=1
    \end{gather*}
    \item
    $F(x,y)$关于每个变量右连续，即
    $F(x,y)=F(x+0,y)=F(x,y+0)$。
    \item
    $F(x_2,y_2)-F(x_2,y_1)-F(x_1,y_2)+F(x_1,y_1)\ge 0$，
    其中$x_1\le x_2, y_1 \le y_2$。
  \end{enumerate}
\end{theorem}

\begin{definition}[二维连续型随机变量与联合概率密度函数]
  对于二维随机变量$(X,Y)$的分布函数$F(x,y)$，
  如果存在非负函数$p(x,y)$，使得对于任意的$x,y$有
  \begin{displaymath}
  F(x,y)=\mintcumto{x}\mintcumto{y}p(u,v)dudv
  \end{displaymath}
  则称$(X,Y)$是\textbf{二维连续型随机变量}，
  函数$p(x,y)$称为$(X,Y)$的\textbf{联合概率密度函数}，
  简称\textbf{概率密度}。
\end{definition}

\begin{theorem}[联合概率密度函数的性质]
  设$p(x,y)$是连续随机向量$(X,Y)$的联合概率密度函数，则
  \begin{enumerate}
    \item
    $p(x,y)\ge 0$
    \item
    $\mintall\mintall p(u,v)dudv = 1$
    \item
    若$p(x,y)$在点$(x,y)$连续，则有
    \[ \frac{\partial^2 F(x,y)}{\partial x\partial y} = p(x,y) \]
    \item
    $P\left((X,Y)\in G\right) = \iint_G p(x,y)dxdy$
  \end{enumerate}
\end{theorem}

\begin{definition}[边缘分布函数]
  设二维随即向量$(X,Y)$的联合分布函数为$F(x,y)$。
  我们定义
  \begin{displaymath}
    F_X(x)=F(x,+\infty)
  \end{displaymath}
  为$X$的\textbf{边缘分布函数}。
  同样地，$F_Y=F(+\infty,y)$为$Y$的边缘分布函数。
\end{definition}

\begin{definition}[边缘密度]
  设二维随即向量$(X,Y)$的概率密度函数为$p(x,y)$，
  联合分布函数为$F(x,y)$。
  我们定义
  \begin{displaymath}
    p_X(x)=F'_X(x) = \mintall p(x,y)dy
  \end{displaymath}
  为$X$的\textbf{边缘密度}。
  同样地，$p_Y(y)=F'_Y(y) = \mintall p(x,y)dx$
  为$Y$的边缘密度。
\end{definition}

\begin{definition}[二维连续型随机变量的条件密度]
  设$(X,Y)$是连续随机向量，则
  \begin{displaymath}
    F_{Y|X=x}(y)=P(Y\le y|X = x)=
      \mintcumto{y}\frac{p(x,v)}{p_X(x)}dv
  \end{displaymath}
  为$Y$在$X=x$的条件下的\textbf{条件分布}。而
  \begin{displaymath}
    p_{Y|X=x}(y)=\frac{p(x,y)}{p_X(x)}
  \end{displaymath}
  为$Y$在$X=x$的条件下的\textbf{条件密度}，也记为$p_{Y|X}(y|x)$。
\end{definition}

\begin{theorem}[条件密度的两个公式]
  条件密度也有乘法公式
  \begin{displaymath}
    p(x,y) = p_X(x)p_{Y|X}(y|x)
  \end{displaymath}
  和全概率公式
  \begin{displaymath}
    p_X(x) = \mintall p(x,y)dy
    = \mintall p_{X|Y}(x|y)p_Y(y)dy
  \end{displaymath}
\end{theorem}

\subsection{连续型随机变量的独立性}
\begin{definition}[两个随机变量的独立性]
  设$X,Y$为随机变量。
  若对任意实数$x,y$，随机事件$X\le x$与$Y\le y$相互独立，即
  \begin{displaymath}
    P(X\le Y\le y)=P(X\le x)P(Y\le y)
  \end{displaymath}
  或等价地，
  \begin{displaymath}
    F(x,y)=F_X(x)F_Y(y)
  \end{displaymath}
  则称随机变量$X$与$Y$相互独立。
\end{definition}

\begin{theorem}[两个连续型随机变量相互独立的条件]
  设$X,Y$为连续型随机变量。若
  \begin{displaymath}
    p(x,y)=p_X(x)p_Y(x)
  \end{displaymath}
  则$X,Y$相互独立。
\end{theorem}

\subsection{二维随机变量函数的分布}
对于二维随机变量$(X,Y)$，实函数$z=g(x,y)$，
可定义随机变量$Z=g(X,Y)$。

使用类似\ref{subsec-disc-rv-func-distribution}节
和\ref{subsec-con-rv-func-distribution}节的方法，
同样可以求出$Z$的分布。
下面给出两个比较特殊的二维随机变量函数的分布：
\textbf{和分布}以及\textbf{极大极小分布}。

\begin{description}
  \item[和分布]
  如果$Z=X+Y$，$p(x,y)$是$X,Y$的概率密度函数，则
  \begin{displaymath}
    p_Z(z) = \mintall p(x,z-x)dx
  \end{displaymath}
  如果$X,Y$相互独立，则能更进一步化为卷积公式
  \begin{displaymath}
    p_Z(z) = \mintall p_X(x)p_Y(z-x)dx
  \end{displaymath}
  \item[极大极小分布]
  如果$X,Y$相互独立。设$M=\max\{X,Y\}$，$N=\min\{X,Y\}$，则
  \begin{align*}
    F_M(z) &= P(\max\{X,Y\}\le z) = P(X\le z, Y\le z) \\
    &= P(X\le z)P(Y\le z) \\
    &= F_X(z)F_Y(z)
  \end{align*}
  \begin{align*}
    F_N(z) &= P(\min\{X,Y\}\le z) = 1 - P(\min\{X,Y\}>z) \\
    &= 1 - P(X>z,Y>z) = 1 - P(X>z)P(Y>z) \\
    &= 1 - (1-F_X(z))(1-F_Y(z))
  \end{align*}
  推广：如果$X_1,X_2,\dots,X_n$相互独立，则
  \begin{gather*}
    F_{\max_iX_i}(z) = \prod_{i=1}^{n}F_{X_i}(z) \\
    F_{\min_iX_i}(z) = 1-\prod_{i=1}^{n}(1-F_{X_i}(z))
  \end{gather*}
\end{description}

\section{常见连续型随机变量的分布}
本小节主要介绍以下常见的连续型随机变量的分布：
均匀分布，指数分布，正态分布，二维均匀分布，二维正态分布。

\subsection{均匀分布}
\begin{definition}[均匀分布]
  设连续型随机变量$X$具有概率密度
  \begin{displaymath}
    p(x) = \begin{cases}
      \frac{1}{b-a} & a < x < b \\
      0 & \text{其它}
    \end{cases}
  \end{displaymath}
  则称$X$在区间上$(a,b)$服从\textbf{均匀分布}，
  记为$X\sim U(a,b)$。它的分布函数为
  \begin{displaymath}
    F(X) = \begin{cases}
      0 & x < a \\
      \frac{x-a}{b-a} & a \le x < b \\
      1 & x > b
    \end{cases}
  \end{displaymath}
\end{definition}

\begin{theorem}[均匀分布的数字特征]
  设随机变量$X\sim U(a,b)$，则
  \begin{displaymath}
    \mexpect[X]=\frac{a+b}{2},\quad \mvar(X)=\frac{(b-a)^2}{12}
  \end{displaymath}
\end{theorem}

\begin{theorem}
  设连续型随机变量$X$的分布函数$F(x)$严格单调递增。
  令$Y=F(X)$，则$Y\sim U(0,1)$。
\end{theorem}

\begin{remark}
  该定理告诉我们，可以利用均匀分布来生成其它分布。
\end{remark}

\subsection{指数分布}
\begin{definition}[指数分布]
  设连续型随机变量$X$的概率密度为
  \begin{displaymath}
    p(x) = \begin{cases}
      \lambda e^{-\lambda x} & x > 0 \\
      0 & x \le 0
    \end{cases}
  \end{displaymath}
  其中$\lambda$为常数，
  则称$X$服从参数为$\lambda$的\textbf{指数分布}，
  记为$X\sim E(\lambda)$。
  它的分布函数为
  \begin{displaymath}
    F(x) = \begin{cases}
      1 - e^{-\lambda x} & x > 0 \\
      0 & x \le 0
    \end{cases}
  \end{displaymath}
\end{definition}

\begin{theorem}[指数分布的数字特征]
  设随机变量$X\sim E(\lambda)$，则
  \begin{displaymath}
    \mexpect[X] = \frac{1}{\lambda},\quad \mvar(X) = \frac{1}{\lambda^2}
  \end{displaymath}
\end{theorem}

\begin{theorem}[指数分布的无记忆性]
  设$X\sim E(\lambda)$，则对于任意实数$s,t>0$有
  \begin{displaymath}
    P(X>s+t|X>t) = P(X>s)
  \end{displaymath}
\end{theorem}

\begin{theorem}[多个独立指数分布的极小分布]
  设$X_i\sim E(\lambda_i)\ (i=1,2,\dots,n)$且相互独立。
  令$Y=\min_i X_i$，则$Y\sim E(\sum_{i=1}^{n}\lambda_i)$，
  且$P(\min_i X_i = X_j)= \lambda_j/\sum_{i=1}^{n}\lambda_i$
\end{theorem}

\subsection{正态分布}
\begin{definition}
  设连续型随机变量$X$的概率密度为
  \begin{displaymath}
    p(x)=\frac{1}{\sqrt{2\pi}\sigma} e^{-\frac{(x-\mu)^2}{2\sigma^2}}
    \ (-\infty < x < +\infty)
  \end{displaymath}
  其中$\mu,\sigma\ (\sigma > 0)$为常数，
  则称$X$服从参数为$\mu,\sigma^2$的\textbf{正态分布}(也叫高斯分布)，
  记为$X\sim N(\mu,\sigma^2)$。
\end{definition}

\begin{theorem}[正态分布的数字特征]
  设随机变量$X\sim N(\mu,\sigma^2)$，则
  \begin{displaymath}
    \mexpect[X] = \mu,\quad \mvar(X) = \sigma^2
  \end{displaymath}
\end{theorem}

\begin{definition}[标准正态分布]
  我们把$N(0,1)$称为\textbf{标准正态分布}。
  标准正态分布的密度函数记为
  \begin{displaymath}
    \phi(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}
    \ (-\infty < x < +\infty)
  \end{displaymath}
  标准正态分布的分布函数记为
  \begin{displaymath}
    \Phi(x) = \mintcumto{x}\frac{1}{\sqrt{2\pi}} e^{-\frac{t^2}{2}} dt
  \end{displaymath}
\end{definition}

\begin{theorem}
  $\forall x\in\mfR$，$\Phi(-x) = 1 - \Phi(x)$
\end{theorem}

\begin{theorem}
  若$X\sim N(0,1)$，则
  \begin{displaymath}
    \mexpect[X^k] = \begin{cases}
      (k-1)!! & \text{$k$为偶数} \\
      0       & \text{$k$为奇数}
    \end{cases}
  \end{displaymath}
  
\end{theorem}
\begin{theorem}[正态分布的性质]
  设$X\sim N(\mu,\sigma^2)$，$Y=aX+b\ (a\neq 0)$，则
  \begin{displaymath}
    Y \sim N\left(a\mu+b,(a\sigma)^2\right)
  \end{displaymath}
\end{theorem}

\begin{corollary}[标准化]
  若$X\sim N(\mu,\sigma^2)$，则$(X-\mu)/\sigma \sim N(0,1)$
\end{corollary}

\begin{remark}
  根据这个推论，任意随机变量$X\sim N(\mu,\sigma^2)$落在在某个区间的概率
  可以转化为标准正态分布来求：
  \begin{align*}
    P(a \le X \le b)
    &= P\left(\frac{a-\mu}{\sigma} \le \frac{X-\mu}{\sigma}
      \le \frac{b-\mu}{\sigma}\right) \\
    &= \Phi\left(\frac{a-\mu}{\sigma}\right)
     - \Phi\left(\frac{b-\mu}{\sigma}\right)
  \end{align*}
  其中$\Phi(x)$可以查表得到。
\end{remark}

\begin{theorem}[3$\sigma$原理]
  设随机变量$X\sim N(\mu,\sigma^2)$，则
  \begin{gather*}
    P(|X-\mu|\le\sigma) = 68.26 \% \\
    P(|X-\mu|\le 2\sigma) = 95.44 \% \\
    P(|X-\mu|\le 3\sigma) = 99.74 \%
  \end{gather*}
\end{theorem}

\begin{theorem}[独立正态分布随机变量的和]
  设$X\sim N(\mu_1,\sigma_1^2), Y\sim N(\mu_2,\sigma_2^2)$，
  且两者独立，则
  \begin{displaymath}
    X + Y \sim N(\mu_1+\mu_2, \sigma_1^2+\sigma_2^2)
  \end{displaymath}
\end{theorem}

\subsection{二维均匀分布}
\begin{definition}[二维均匀分布]
  设$D$是平面上的有界区域，其面积为$A$。
  如果二维随机变量$(X,Y)$的密度函数为
  \begin{displaymath}
    p(x,y) = \begin{cases}
      \frac{1}{A} & (x,y)\in D \\
      0 & (x,y)\notin D
    \end{cases}
  \end{displaymath}
  则称$(X,Y)$服从$D$上的二维均匀分布。
\end{definition}

\subsection{二维正态分布}
\begin{definition}[二维正态分布]
  若二维随机变量$(X,Y)$具有密度函数
  \begin{align*}
    p(x,y)=&\frac{1}{2\pi\sigma_1\sigma_2\sqrt{1-\rho^2}}
      \exp\left\{-\frac{1}{2(1-\rho^2)}\left[
        \left(\frac{x-\mu_1}{\sigma_1}\right)^2\right.\right.\\
        &\left.\left.-2\rho\left(\frac{x-\mu_1}{\sigma_1}\right)
          \left(\frac{y-\mu_2}{\sigma_2}\right)
        +\left(\frac{y-\mu_2}{\sigma_2}\right)^2\right]\right\}
  \end{align*}
  其中$\mu_1,\mu_2,\sigma_1,\sigma_2 > 0, |\rho| < 1$均为常数，
  则称$(X,Y)$服从\textbf{二维正态分布}，记作
  $(X,Y)\sim N(\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho)$。
\end{definition}

\begin{remark}
  这里$\rho$的含义是相关系数，参见\ref{subset-correlation-coefficent}节。
\end{remark}

\begin{theorem}[二维正态分布的性质]
  设$(X,Y)\sim N(\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho)$，则
  \begin{enumerate}
    \item
    $X\sim N(\mu_1,\sigma_1^2)$，$Y\sim N(\mu_2,\sigma_2^2)$，
    即二维正态分布的边缘分布仍是正态分布。
    \item
    $X,Y$相互独立当且仅当$\rho = 0$。
    \item
    $\mcov(X,Y) = \rho\sigma_1\sigma_2$
  \end{enumerate}
\end{theorem}

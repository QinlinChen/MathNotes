\chapter{参数估计}

\section{点估计}
本小节首先讨论两种点估计的方法：矩估计和极大似然估计。
然后讨论估计量的评选标准。

\subsection{点估计的概念}
参数的\textbf{点估计}就是对总体分布中的未知参数$\theta$，
以样本$X_1,X_2,\dots,X_n$构造统计量
$\hat{\theta}(X_1,X_2,\dots,X_n)$作为参数$\theta$的估计，
称$\hat{\theta}(X_1,X_2,\dots,X_n)$为参数$\theta$\textbf{估计量}。

当测得样本值$(x_1,x_2,\dots,x_n)$时，
代入$\hat{\theta}(X_1,X_2,\dots,X_n)$，
即可得到参数$\theta$\textbf{估计值}：
$\hat{\theta}(x_1,x_2,\dots,x_n)$。

\subsection{矩估计}
矩估计的思想是：以样本矩作为总体矩的估计，从而得到参数的估计量。
具体方法如下。

设$X_1,X_2,\dots,X_n$为来自总体$X$的样本，总体$X$的分布函数为
\begin{displaymath}
  F(x;\theta_1,\theta_2,\dots,\theta_k)
\end{displaymath}
其中$\theta_1,\theta_2,\dots,\theta_k$为未知参数。
记$\mu_m(\theta_1,\theta_2,\dots,\theta_k)=\mexpect[X^m]$
为总体的$m$阶矩，
$A_m=\frac{1}{n}\sum_{i=1}^{n}X_i^m$为样本的$m$阶矩。

若$\mu_m\ (m=1,2,\dots,k)$都存在，那么我们联立方程
\begin{displaymath}
  \meqs{c}{
    \mu_1(\theta_1,\theta_2,\dots,\theta_k) = A_1 \\
    \vdots \\
    \mu_k(\theta_1,\theta_2,\dots,\theta_k) = A_k
  }
\end{displaymath}
从中解出方程组的解$\hat{\theta}_1,\hat{\theta}_2,\dots,\hat{\theta}_k$。

我们把$\hat{\theta}_1,\hat{\theta}_2,\dots,\hat{\theta}_k$
作为$\theta_1,\theta_2,\dots,\theta_k$的估计量，称为\textbf{矩估计量}。
矩估计量的观察值叫做\textbf{矩估计值}。

\begin{theorem}
  无论总体$X$服从何种分布，
  若总体均值$\mu$和总体方差$\sigma^2$为未知参数，
  那么其矩估计量一定是样本均值和样本方差，即：
  \begin{displaymath}
    \hat{\mu}=\mbar{X},\quad \hat{\sigma^2}=S_n^2
  \end{displaymath}
\end{theorem}

\begin{remark}
  注意，对于矩估计来说，$\hat{\sigma^2}$和$\hat{\sigma}^2$不一定是相同的。
  前者是方差的矩估计量，后者是标准差矩估计量的平方。
  但对于后面介绍的极大似然估计来说，它们是相同的。
\end{remark}

\subsection{极大似然估计}
极大似然估计的思想是：
以样本$X_1,X_2,\dots,X_n$的观测值$x_1,x_2,\dots,x_n$来
估计参数$\theta_1,\theta_2,\dots,\theta_k$。
若选取$\hat{\theta}_1,\hat{\theta}_2,\dots,\hat{\theta}_k$
使观测值出现的概率最大，那么把
$\hat{\theta}_1,\hat{\theta}_2,\dots,\hat{\theta}_k$
作为参数$\theta_1,\theta_2,\dots,\theta_k$的估计量。
下面分离散和连续两种情形来讨论具体方法。

\begin{enumerate}
  \item
  若总体$X$为离散型，其分布律的形式已知为
  \begin{displaymath}
    P(X=x) = f(x; \theta)
  \end{displaymath}
  其中$\theta$为待估参数(这里仅讨论一个参数的情况)。
  又设$x_1,x_2,\dots,x_n$是样本$X_1,X_2,\dots,X_n$的一组样本值。
  那么事件$X_1=x_1$，$X_2=x_2$，$\dots$，$X_n=x_n$同时发生的概率为
  \begin{displaymath}
    L(\theta) = P(X_1=x_1,X_2=x_2,\dots,X_n=x_n)
    = \prod_{i=1}^n f(x_i;\theta)
  \end{displaymath}
  我们把$L(\theta)$称为样本的\textbf{极大似然函数}。取
  \begin{displaymath}
    \hat{\theta}(x_1,x_2,\dots,x_n)= \argmax_\theta L(\theta)
  \end{displaymath}
  为参数$\theta$的\textbf{极大似然估计值}。
  $\hat{\theta}(X_1,X_2,\dots,X_n)$称为$\theta$的\textbf{极大似然估计量}。
  \item
  若总体$X$为连续型，其概率密度的形式已知为
  \begin{displaymath}
    p(x;\theta)
  \end{displaymath}
  其中$\theta$为待估参数(这里仅讨论一个参数的情况)。
  设$x_1,x_2,\dots,x_n$是样本$X_1,X_2,\dots,X_n$的一组样本值，
  那么连续型随机变量的极大似然函数为
  \begin{displaymath}
    L(\theta) = \prod_{i=1}^n p(x_i;\theta)
  \end{displaymath}
  其极大似然估计量和估计值的定义和离散型的定义相同。
\end{enumerate}

现在我们讨论求解$\hat{\theta}=\argmax_\theta L(\theta)$的方法。
若极大似然函数$L$只有一个参数，即$L=L(\theta)$，
那么通过下列方程来解$\theta$：
\begin{displaymath}
  \frac{\md L}{\md \theta}=0
  \quad\text{或}\quad
  \frac{\md \ln L}{\md \theta}=0
\end{displaymath}
若极大似然函数$L$有多个参数，即$L=L(\theta_1,\theta_2,\dots,\theta_k)$，
那么通过下列方程组来解$\theta_1,\theta_2,\dots,\theta_k$：
\begin{displaymath}
  \meqs{c}{
    \mpartials{\theta_1}{L} = 0\\
    \vdots \\
    \mpartials{\theta_k}{L} = 0
  }\quad\text{或}\quad
  \meqs{c}{
    \mpartials{\theta_1}{\ln L} = 0\\
    \vdots \\
    \mpartials{\theta_k}{\ln L} = 0
  }
\end{displaymath}

\begin{theorem}[极大似然估计的不变性]
  设$\hat{\theta}$是$\theta$的极大似然估计量，
  $u=u(\theta)$是$\theta$的函数，且有单值反函数，
  则$\hat{u}=u(\hat{\theta})$是$u(\theta)$的极大似然估计量。
\end{theorem}

\subsection{估计量的评选标准}

\begin{definition}[无偏性]
  设$\theta$的估计量为$\hat{\theta}$。若
  $\mexpect[\hat{\theta}]=\theta$，
  则称$\hat{\theta}$是$\theta$的\textbf{无偏估计量}。
\end{definition}

\begin{remark}
  $S_n^2$不是$\sigma^2$的无偏估计量，
  而$S_{n-1}^2$才是$\sigma_2$的无偏估计量，
  但$S_{n-1}$不是$\sigma$的无偏估计量。
  由此也能看出，$\hat{\theta}$是$\theta$的无偏估计量
  不一定能推出$g(\hat{\theta})$是$g(\theta)$的无偏估计量。
\end{remark}

\begin{definition}[有效性]
  设$\hat{\theta}_1,\hat{\theta}_2$是$\theta$的无偏估计量。
  若$\mvar(\hat{\theta}_2)\le \mvar(\hat{\theta}_1)$，
  则称$\hat{\theta}_2$比$\hat{\theta}_1$\textbf{有效}。
\end{definition}

\begin{definition}[一致性]
  设$\hat{\theta}_n=\hat{\theta}_n(X_1,X_2,\dots,X_n)$
  是$\theta$的估计量。
  若$\hat{\theta}_n \mprto \theta$，
  则称$\hat{\theta}_n$是$\theta$的\textbf{一致估计量}。
\end{definition}

下面是两个常用的结论：

\begin{theorem}
  样本的$k$阶矩是总体$k$阶矩的一致性估计量。
\end{theorem}

\begin{theorem}
  设$\hat{\theta}$是$\theta$的无偏估计量。若
  \begin{displaymath}
    \lim_{n\to\infty}\mvar(\hat{\theta})=0
  \end{displaymath}
  则$\hat{\theta}$是$\theta$的一致估计量。
\end{theorem}

\begin{remark}
  使用切比雪夫不等式证明。
\end{remark}

\section{区间估计}
本小节首先给出区间估计的概念和用来求置信区间的枢轴变量法。
然后就单正态总体和双正态总体给出求它们一些参数的置信区间的示例。
最后讨论一下单侧置信区间和非正态总体均值的区间估计。

\subsection{区间估计的概念}
参数的\textbf{区间估计}是对总体分布中的未知参数$\theta$，
以样本$X_1,X_2,\dots,X_n$构造两个统计量
$\hat{\theta}_1(X_1,X_2,\dots,X_n)$和
$\hat{\theta}_2(X_1,X_2,\dots,X_n)$，
以区间$[\hat{\theta}_1,\hat{\theta}_2]$作为参数$\theta$的估计，
使得对给定的概率$1-\alpha$，满足：
\begin{displaymath}
  P\left(\hat{\theta}_1(X_1,X_2,\dots,X_n) < \theta <
    \hat{\theta}_2(X_1,X_2,\dots,X_n)\right) = 1-\alpha
\end{displaymath}
我们称$[\hat{\theta}_1,\hat{\theta}_2]$为\textbf{置信区间}，
$1-\alpha$为该区间的\textbf{置信度}。

几点说明：
\begin{enumerate}
  \item
  置信区间的长度$L$反映了估计精度。$L$越小，估计精度越高。
  \item
  $\alpha$反映了估计的可靠度。
  $\alpha$约小越可靠，但这时$L$往往增大，因而估计精度降低。
  \item
  $\alpha$确定后，置信区间的选取方法不唯一，常选长度最小的一个。
\end{enumerate}

\subsection{枢轴变量法}
可以使用如下所述的\textbf{枢轴变量法}来寻找置信区间：
\begin{enumerate}
  \item
  先找到一样本函数$U(X_1,X_2,\dots,X_n;\theta)$，
  其包含待估参数$\theta$，而不包含其他未知参数，
  且$U$的分布已知，不依赖于任何未知参数。
  $U$被称为\textbf{枢轴变量}。
  \item
  给定置信度$1-\alpha$，根据$U$的分布找两个常数$a$和$b$，使得
  \begin{displaymath}
    P(a<U<b)=1-\alpha
  \end{displaymath}
  \item
  由$a<U<b$解出$\hat{\theta}_1<\theta<\hat{\theta}_2$，
  则$[\hat{\theta}_1,\hat{\theta}_2]$为所求的置信区间。
\end{enumerate}

\subsection{单正态总体的均值和方差的区间估计}
设$X_1,X_2,\dots,X_n$为正态总体$X\sim N(\mu,\sigma^2)$的一个样本，
置信度为$1-\alpha$。
\begin{enumerate}
  \item
  已知方差$\sigma^2$，求均值$\mu$的置信区间：
  \begin{align*}
    &\because U = \frac{\mbar{X}-\mu}{\sigma/\sqrt{n}}\sim N(0,1) \\
    &\therefore P\left(-u_{\alpha/2} \le U
      \le u_{\alpha/2}\right) = 1-\alpha \\
    &\therefore P\left(\mbar{X}-u_{\alpha/2}\frac{\sigma}{\sqrt{n}}\le\mu
      \le\mbar{X}+u_{\alpha/2}\frac{\sigma}{\sqrt{n}}\right) = 1-\alpha \\
    &\therefore \text{置信区间为}
     \left[\mbar{X}-u_{\alpha/2}\frac{\sigma}{\sqrt{n}},
       \mbar{X}+u_{\alpha/2}\frac{\sigma}{\sqrt{n}}\right]
  \end{align*}
  \item
  方差未知，求均值$\mu$的置信区间：
  \begin{align*}
    &\because \frac{\mbar{X}-\mu}{S_n/\sqrt{n-1}}\sim t(n-1) \\
    &\therefore P\left(-t_{\alpha/2}(n-1)
      \le \frac{\mbar{X}-\mu}{S_n/\sqrt{n-1}}
      \le t_{\alpha/2}(n-1)\right) = 1-\alpha \\
    &\therefore \text{置信区间为}
      \left[\mbar{X}-t_{\alpha/2}(n-1)\frac{S_n}{\sqrt{n-1}},
        \mbar{X}+t_{\alpha/2}(n-1)\frac{S_n}{\sqrt{n-1}}\right]
  \end{align*}
  \item
  求方差$\sigma^2$的置信区间：
  \begin{align*}
    &\because \frac{nS_n^2}{\sigma^2}\sim \chi^2(n-1) \\
    &\therefore P\left(\chi^2_{1-\alpha/2}(n-1)
      \le \frac{nS_n^2}{\sigma^2}
      \le \chi^2_{\alpha/2}(n-1)\right) = 1-\alpha \\
    &\therefore \text{置信区间为}
      \left[\frac{nS_n^2}{\chi^2_{\alpha/2}(n-1)},
        \frac{nS_n^2}{\chi^2_{1-\alpha/2}(n-1)}\right]
  \end{align*}
\end{enumerate}

\subsection{双正态总体的均值差和方差比的区间估计}
设$X_1,X_2,\dots,X_{n_1}$为正态总体$X\sim N(\mu_1,\sigma_1^2)$的样本，
$Y_1,Y_2,\dots,Y_{n_2}$为正态总体$Y\sim N(\mu_2,\sigma_2^2)$的样本。
$\mbar{X},S_1^2,\mbar{Y},S_2^2$分别表示$X,Y$的样本均值与修正样本方差。
设$X,T$独立，置信度为$1-\alpha$。
\begin{enumerate}
  \item
  已知$\sigma_1^2,\sigma_2^2$，求均值差$\mu_1-\mu_2$的置信区间：
  \begin{align*}
    &\because \frac{(\mbar{X}-\mbar{Y})-(\mu_1-\mu_2)}
      {\sqrt{\frac{\sigma_1^2}{n_1}+\frac{\sigma_2^2}{n_2}}}\sim N(0,1) \\
    &\therefore P\left(-u_{\alpha/2}
      \le \frac{(\mbar{X}-\mbar{Y})-(\mu_1-\mu_2)}
        {\sqrt{\frac{\sigma_1^2}{n_1}+\frac{\sigma_2^2}{n_2}}}
      \le u_{\alpha/2}\right) = 1-\alpha \\
    &\therefore \text{置信区间为}
      \left[\left(\mbar{X}-\mbar{Y}\right)-u_{\alpha/2}
        \sqrt{\frac{\sigma_1^2}{n_1}+\frac{\sigma_2^2}{n_2}},
        \left(\mbar{X}-\mbar{Y}\right)+u_{\alpha/2}
        \sqrt{\frac{\sigma_1^2}{n_1}+\frac{\sigma_2^2}{n_2}}\right]
  \end{align*}
  \item
  求方差比$\sigma_1^2/\sigma_2^2$的置信区间：
  \begin{align*}
    &\because \frac{S_1^2/S_2^2}{\sigma_1^2/\sigma_2^2}
      \sim F(n_1-1,n_2-1) \\
    &\therefore P\left(F_{1-\alpha/2}(n_1-1,n_2-1)
      \le \frac{S_1^2/S_2^2}{\sigma_1^2/\sigma_2^2}
      \le F_{\alpha/2}(n_1-1,n_2-1)\right) = 1-\alpha \\
    &\therefore \text{置信区间为}
      \left[\frac{S_1^2}{S_2^2}\frac{1}{F_{\alpha/2}(n_1-1,n_2-1)},
        \frac{S_1^2}{S_2^2}\frac{1}{F_{1-\alpha/2}(n_1-1,n_2-1)}\right]
  \end{align*}
\end{enumerate}

\subsection{单侧置信区间}
对总体分布中的未知参数$\theta$，
以样本$X_1,X_2,\dots,X_n$构造统计量
\begin{displaymath}
  \hat{\theta}_1(X_1,X_2,\dots,X_n)
\end{displaymath}
以区间$[\hat{\theta}_1,+\infty)$作为参数$\theta$的估计，
使得对给定的概率$1-\alpha$，满足：
\begin{displaymath}
  P\left(\theta>\hat{\theta}_1(X_1,X_2,\dots,X_n)\right) = 1-\alpha
\end{displaymath}
则称$[\hat{\theta}_1,+\infty)$是$\theta$置信度为$1-\alpha$的
\textbf{单侧置信区间}。$\hat{\theta}_1$称为\textbf{单侧置信下限}。
同样地能定义\textbf{单侧置信上限}。

以正态总体的单侧置信区间为例。
设$X_1,X_2,\dots,X_n$为正态总体$X\sim N(\mu,\sigma^2)$的一个样本。
\begin{enumerate}
  \item
  若$\sigma^2$未知，求$\mu$的$1-\alpha$单侧置信下限：
  \begin{align*}
    &\because \frac{\mbar{X}-\mu}{S_n/\sqrt{n-1}}\sim t(n-1) \\
    &\therefore P\left(\frac{\mbar{X}-\mu}{S_n/\sqrt{n-1}}
      \le t_{\alpha}(n-1)\right) = 1-\alpha \\
    &\therefore \text{单侧置信区间为}
      \left[\mbar{X}-t_{\alpha}(n-1)\frac{S_n}{\sqrt{n-1}},
        +\infty\right.\Big)
  \end{align*}
  \item
  求$\sigma^2$的$1-\alpha$单侧置信上限：
  \begin{align*}
    &\because \frac{nS_n^2}{\sigma^2}\sim \chi^2(n-1) \\
    &\therefore P\left(\frac{nS_n^2}{\sigma^2}
      \ge \chi^2_{1-\alpha}(n-1)\right) = 1-\alpha \\
    &\therefore \text{置信区间为}
      \Big(\left.-\infty,
        \frac{nS_n^2}{\chi^2_{1-\alpha}(n-1)}\right]
  \end{align*}
\end{enumerate}

\subsection{非正态总体均值的区间估计}
总体分布非正态时，通常很难求出统计量的具体分布。
若样本量较大，可利用极限定理求出枢轴变量的近似分布，再求出未知参数的区间估计。

例如，设$X_1,X_2,\dots,X_n$为来自均值为$\mu$，方差为$\sigma^2$的总体的一组样本。
如果要求均值$\mu$的置信度为$1-\alpha$的置信区间，
那么当$n$充分大时，由中心极限定理可知，
\begin{displaymath}
  \frac{\mbar{X}-\mu}{\sigma/\sqrt{n}}\stackrel{\text{近似}}{\sim}N(0,1)
\end{displaymath}
若$\sigma$未知，可以用修正样本标准差$S_{n-1}$代替，
由此得$\mu$的置信度为$1-\alpha$的置信区间为
\begin{displaymath}
  \left[\mbar{X}-u_{\alpha/2}\frac{S_{n-1}}{\sqrt{n}},
  \mbar{X}+u_{\alpha/2}\frac{S_{n-1}}{\sqrt{n}}\right]
\end{displaymath}

\chapter{内积空间与正交性}

\section{内积空间}
我们知道线性空间是对向量的抽象，而向量还有内积的概念没有出现在线性空间中。
所以，本小节首先在线性空间的基础上引入内积操作来定义内积空间，
从而建立了长度、交角、正交性的概念。
然后根据线性空间数域的不同，我们会在有限维上分别讨论欧几里得空间和酉空间。
最后，我们讨论一下线性空间和欧几里得空间同构的概念，
说明它们都同构于我们常用的向量空间。

\subsection{实内积空间与欧几里得空间}
\begin{definition}[实内积空间与欧几里得空间]
  设$V$是实数域$\mfR$上的一个线性空间。
  对于任意$\alpha,\beta\in V$，
  定义一个返回实数的运算$(\alpha,\beta)$，满足：
  \begin{enumerate}
    \item 对称性：
    $(\alpha,\beta)=(\beta,\alpha)$
    \item 线性性：
    $(k\alpha,\beta)=k(\alpha,\beta),\quad
      (\alpha+\beta,\gamma)=(\alpha,\gamma)+(\beta,\gamma)$
    \item 正定性：
    $(\alpha,\alpha)\ge 0$。
    当且仅当$\alpha=\theta$时，$(\alpha,\alpha)=0$
  \end{enumerate}
  其中$\alpha,\beta,\gamma\in V, k\in\mfR$。
  我们称$(\alpha,\beta)$为$\alpha,\beta$的\textbf{内积}，
  $V$为\textbf{实内积空间}。
  有限维的实内积空间又称\textbf{欧几里得空间}。
\end{definition}

\begin{theorem}[实内积空间的性质] \label{thrm:real-inner-prod-space-prop}
  设$V$是实内积空间。对于$\alpha,\beta,\gamma\in V, k\in\mfR$，有
  \begin{enumerate}
    \item \label{thrm:RIPS-prop1}
    $(\alpha,\beta+\gamma)=(\alpha,\gamma)+(\beta,\gamma)$
    \item
    $(\alpha,k\beta)=k(\alpha,\beta)$
    \item
    $(\theta,\beta)=0=(\alpha,\theta)$
    \item
    $(\alpha,\beta)=
      \left(\sum_{i=1}^{m}a_i\alpha_i,\sum_{j=1}^{n}b_j\beta_j\right) $
    \begin{equation} \label{eq:metric-mat}
      = (a_1,a_2,\dots,a_m) \mmat{cccc}{
        (\alpha_1,\beta_1)&(\alpha_1,\beta_2)&\cdots&(\alpha_1,\beta_n)\\
        (\alpha_2,\beta_1)&(\alpha_2,\beta_2)&\cdots&(\alpha_2,\beta_n)\\
        \vdots            &\vdots            &\ddots&\vdots            \\
        (\alpha_m,\beta_1)&(\alpha_m,\beta_2)&\cdots&(\alpha_m,\beta_n)}
        \mmat{c}{b_1 \\ b_2 \\ \vdots \\ b_n}
    \end{equation}
  \end{enumerate}
\end{theorem}

\begin{definition}[长度]
  设$V$是实内积空间。对于$\alpha\in V$，
  $\| \alpha \| = \sqrt{(\alpha,\alpha)}$
  称为$\alpha$的\textbf{长度}或\textbf{模}。
\end{definition}

\begin{theorem}[柯西-施瓦兹(Cauchy-Schwartz)不等式]
  设$V$是实内积空间。对于任意$\alpha,\beta\in V$，有
  \begin{displaymath}
    |(\alpha,\beta)| \le \|\alpha\|\cdot\|\beta\|
  \end{displaymath}
  等号仅在$\alpha,\beta$线性相关时成立。
\end{theorem}

\begin{definition}[交角]
  实内积空间中的两个非零向量$\alpha,\beta$的交角$\theta$定义为
  \begin{displaymath}
    \theta = \arccos\frac{(\alpha,\beta)}{\|\alpha\|\cdot\|\beta\|},
    \quad  0\le\theta\le\pi
  \end{displaymath}
\end{definition}

\begin{definition}[正交]
  设$\alpha,\beta$是实内积空间中的两个向量。
  若$(\alpha,\beta)=0$，则称$\alpha,\beta$\textbf{正交}，
  记作$\alpha\perp\beta$。
\end{definition}

\begin{remark}
  零向量与任意向量正交。
\end{remark}

\begin{theorem}[正交的充要条件]
  设$\alpha,\beta$是实内积空间中的两个向量，则
  \begin{displaymath}
    \alpha\perp\beta \iff \|\alpha+\beta\|^2=\|\alpha\|^2+\|\beta\|^2
  \end{displaymath}
\end{theorem}

\subsection{复内积空间与酉空间}
\begin{definition}[复内积空间与酉空间]
  设$V$是复数域$\mfC$上的一个线性空间。
  对于任意$\alpha,\beta\in V$，
  定义一个返回复数的运算$(\alpha,\beta)$，满足：
  \begin{enumerate}
    \item 共轭对称性：
    $(\alpha,\beta)=\mconj{(\beta,\alpha)}$
    \item 线性性：
    $(k\alpha,\beta)=k(\alpha,\beta),\quad
      (\alpha+\beta,\gamma)=(\alpha,\gamma)+(\beta,\gamma)$
    \item 正定性：
    $(\alpha,\alpha)$是非负实数。
    当且仅当$\alpha=\theta$时，$(\alpha,\alpha)=0$
  \end{enumerate}
  其中$\alpha,\beta,\gamma\in V, k\in\mfC$。
  我们称$(\alpha,\beta)$为$\alpha,\beta$的\textbf{内积}，
  $V$为\textbf{复内积空间}。
  有限维的复内积空间又称\textbf{酉空间}。
\end{definition}

\begin{theorem}[复内积空间的性质]
  复内积空间满足定理\ref{thrm:real-inner-prod-space-prop}列出的
  除了性质\ref{thrm:RIPS-prop1}以外的所有性质。
  性质\ref{thrm:RIPS-prop1}应该改写为：
  \[ (\alpha,k\beta)=\mconj{k}(\alpha,\beta) \]
\end{theorem}

复内积空间的长度、正交性同实内积空间定义。
柯西-施瓦兹不等式依旧成立。
只有交角要重新定义为
\begin{displaymath}
  \theta = \arccos\frac{|(\alpha,\beta)|}{\|\alpha\|\cdot\|\beta\|},
  \quad 0\le\theta\le\frac{\pi}{2}
\end{displaymath}

下面是复矩阵相关的三个概念。
只用了解一下，不会深入讨论。

\begin{definition}[共轭矩阵]
  设$\mmA$是$n$阶复矩阵。
  把$\mmA$的元素都取共轭得到的矩阵叫做\textbf{共轭矩阵}，
  记作$\mconj{\mmA}$。
\end{definition}

\begin{definition}[酉矩阵]
  设$\mmA$是$n$阶复矩阵。
  若$\mmA$满足$\mconj{\mmA^\mT}\mmA=\mmA\mconj{\mmA^\mT}=\mmI$，
  则称$\mmA$是\textbf{酉矩阵}。
\end{definition}

\begin{remark}
  酉矩阵是对正交矩阵的推广。正交矩阵会在下面讨论。
\end{remark}

\begin{definition}[厄米特(Hermite)矩阵]
  设$\mmA$是$n$阶复矩阵。
  若$\mmA$满足$\mconj{\mmA^\mT}=\mmA$，
  则称$\mmA$是\textbf{厄米特(Hermite)矩阵}
\end{definition}

\begin{remark}
  厄米特矩阵是对对称矩阵的推广。
\end{remark}

\subsection{空间的同构}
\begin{definition}[线性空间的同构]
  设$V,W$是两个数域$\mfF$上的线性空间。
  如果存在一个一一映射$f:V\mapsto W$，满足
  \begin{enumerate}
    \item
    $f(\alpha+\beta)=f(\alpha)+f(\beta)$
    \item
    $f(k\alpha)=kf(\alpha)$
  \end{enumerate}
  其中$\alpha,\beta\in V,k\in\mfF$，
  则称$V$和$W$\textbf{同构}。$f$被称为\textbf{同构映射}。
\end{definition}

\begin{definition}[欧几里得空间的同构]
  设$V,W$是两个欧几里得空间。
  如果存在一个一一映射$f:V\mapsto W$，
  除了满足线性空间同构的两个条件外，还满足
  \[ (f(\alpha), f(\beta) = (\alpha, \beta) \]
  其中$\alpha,\beta\in V$，
  则称$V$和$W$\textbf{同构}。$f$被称为\textbf{同构映射}。
\end{definition}

\begin{theorem}[线性空间同构的充要条件]
  数域$\mfF$上的两个线性空间$V,W$同构当且仅当$\mdim V = \mdim W$。
\end{theorem}

\begin{remark}
  这意味着数域$\mfF$上的$n$维线性空间都同构于$\mfF^n$。
\end{remark}

\begin{theorem}[欧几里得空间同构的充要条件]
  两个欧几里得空间$V,W$同构当且仅当$\mdim V = \mdim W$。
\end{theorem}

\begin{remark}
  这意味着$n$维线性空间都同构于$\mfR^n$。
\end{remark}

\section{欧几里得空间的标准正交基}
根据式\eqref{eq:metric-mat}，我们能发现，给定一组基，
任意两个元素的内积可以通过坐标向量和一个与这组基相关联矩阵来计算，
我们把这样的矩阵定义为度量矩阵，以此为起点开始讨论。

首先，我们会探寻不同基的度量矩阵之间的关系，并把这种关系称为合同关系。

然后，我们希望会有这样一组基，它的度量矩阵是单位矩阵，
因为这样能大大简化我们的内积运算。我们把这样的基叫做标准正交基。
我们会证明，标准正交基一定是存在的，
并给出求标准正交基的方法——施密特(Schmit)正交化。

\subsection{度量矩阵与矩阵的合同}
\begin{definition}[度量矩阵]
  设$V$是$n$维欧几里得空间，$\alpha_1,\dots,\alpha_n$是一组基底。
  对任意$\alpha,\beta\in V$，存在坐标向量$\mvx,\mvy$，使得
  $\alpha=\mmBasis{\alpha}\mvx$，$\beta=\mmBasis{\alpha}\mvy$。
  根据式\eqref{eq:metric-mat}，我们有
  \begin{displaymath}
    (\alpha,\beta) = \mvx^\mT\mmA\mvy
  \end{displaymath}
  其中，$\mmA$如式\eqref{eq:metric-mat}中所示。
  我们称矩阵$\mmA$为维欧几里得空间在基底$\alpha_1,\dots,\alpha_n$下的
  \textbf{度量矩阵}。
\end{definition}

线性变换在不同基下对应的矩阵之间有着相似关系，
那么欧几里得空间不同基下的度量矩阵有什么关系呢？

\begin{definition}[矩阵的合同]
  设$\mmA,\mmB$是两个$n$阶方阵，如果有满秩方阵$M$，
  使得$\mmB=\mmM^T\mmA\mmM$，则称$\mmA$与$\mmB$\textbf{合同}。
\end{definition}

\begin{remark}
  合同关系是等价关系。
\end{remark}

\begin{theorem}[不同基底下的度量矩阵的关系] \label{thrm:metric-mat-rel}
  欧几里得空间中两组不同基底下的度量矩阵是合同的。
\end{theorem}

\begin{remark}
  如果$\mmBasis{\alpha},\mmBasis{\beta}$是欧几里得空间的两组基底，
  它们的度量矩阵分别是$\mmA$和$\mmB$，
  由$\mmBasis{\alpha}$到$\mmBasis{\beta}$的过渡矩阵为$\mmP$，
  那么$\mmB=\mmP^\mT\mmA\mmP$。
  合同关系就是由此来定义的。
\end{remark}

\subsection{标准正交基与施密特(Schmit)正交化}
\begin{definition}[标准正交基]
  若$n$维欧几里得空间在基底$\alpha_1,\dots,\alpha_n$下的度量矩阵为单位矩阵，
  那么我们称$\alpha_1,\dots,\alpha_n$为\textbf{标准正交基}。
\end{definition}

\begin{remark}
  欧几里得空间的标准正交基是一组长度为1的两两正交的向量组。
  欧几里得空间的任意两个元素的内积就是它们对于标准正交基的坐标向量的内积。
\end{remark}

\begin{theorem}[施密特(Schmit)正交化]
  在$n$维欧几里得空间$V$中给定任意一组基$\alpha,\alpha_2,\alpha_n$，
  我们都由此找到一组标准正交基$\beta_1,\beta_2,\dots,\beta_n$：
  \begin{enumerate}
    \item
    令$\beta_1=\alpha_1$。
    \item
    令$\beta_2=k_1\beta_1+\alpha_2$。利用$(\beta_2,\beta_1)=0$能解得
    \begin{displaymath}
      k_1 = -\frac{(\alpha_2,\beta_1)}{(\beta_1,\beta_1)}
    \end{displaymath}
    代入回去就能得到$\beta_2$。
    \item
    令$\beta_3=k_1\beta_1+k_2\beta_2+\alpha_3$。
    利用$(\beta_3,\beta_1)=0,(\beta_3,\beta_2)=0$，能解得
    \begin{displaymath}
      k_1 = -\frac{(\alpha_3,\beta_1)}{(\beta_1,\beta_1)},\quad
      k_2 = -\frac{(\alpha_3,\beta_2)}{(\beta_2,\beta_2)}
    \end{displaymath}
    代入回去就能得到$\beta_3$。
    \item
    以此类推，令$\beta_{s+1}=k_1\beta_1+\dots+k_2\beta_s+\alpha_{s+1}$。
    利用\[ (\beta_{s+1},\beta_{i})=0,\ i=1,\dots,s \]
    能解得
    \begin{displaymath}
      k_i = -\frac{(\alpha_{s+1},\beta_{i})}{(\beta_{i},\beta_{i})},
      \ i=1,\dots,s
    \end{displaymath}
    代入回去就能得到$\beta_s$。
    \item
    最后对求得的$\beta_1,\dots,\beta_n$单位化，
    即令$\beta_i\leftarrow\frac{1}{\|\beta_i\|}\beta_i$，
    $i=1,\dots,n$。
  \end{enumerate}
\end{theorem}

\section{正交矩阵与正交变换}
欧几里得空间的两组标准正交基之间的过渡矩阵$\mmP$有着特殊的性质：
因为标准正交基的度量矩阵是单位矩阵，所以根据定理\ref{thrm:metric-mat-rel}，
有$\mmI=\mmP^\mT\mmI\mmP=\mmP^\mT\mmP$。
满足这种性质的矩阵$\mmP$我们将称之为正交矩阵。

这一小节，我们会讨论一些正交矩阵的性质，以及与之对应的正交变换的性质。

\subsection{正交矩阵}
\begin{definition}[正交矩阵]
  若$n$阶实矩阵$\mmA$满足
  \[ \mmA\mmA^\mT = \mmA^\mT\mmA = \mmI \]
  则称$\mmA$为\textbf{正交矩阵}。
\end{definition}

\begin{theorem}[正交矩阵的性质]
  正交矩阵具有以下性质
  \begin{enumerate}
    \item
    两个同阶正交矩阵的乘积也是正交矩阵。
    \item
    正交矩阵的逆矩阵是正交矩阵。
    \item
    正交矩阵的行列式为1或-1。
  \end{enumerate}
\end{theorem}

\begin{theorem}
  欧几里得空间中由标准正交基到标准正交基的过渡矩阵是正交矩阵。
\end{theorem}

\begin{remark}
  这是引言提到的结论。
\end{remark}

\begin{theorem}
  设$\epsilon_1,\epsilon_2,\dots,\epsilon_n$是一组标准正交基，
  $\mmP$是正交矩阵，且
  \begin{displaymath}
    (\beta_1,\beta_2,\dots,\beta_n) =
      (\epsilon_1,\epsilon_2,\dots,\epsilon_n)\mmP
  \end{displaymath}
  那么$\beta_1,\beta_2,\dots,\beta_n$也是一组标准正交基。
\end{theorem}

\subsection{正交变换}
\begin{definition}[正交变换]
  设$T$是欧几里得空间$V$的一个线性变换，且对任意$\alpha,\beta\in V$，有
  \begin{displaymath}
    (T(\alpha), T(\beta)) = (\alpha,\beta)
  \end{displaymath}
  则称$T$是一个正交变换。
\end{definition}

\begin{theorem}[正交变换的等价条件]
  设$T$是欧几里得空间$V$的一个线性变换，则以下四个命题等价：
  \begin{enumerate}
    \item
    $T$是正交变换。
    \item
    $T$不改变向量的长度，即$\forall\alpha\in V$，
    $\|T(\alpha)\|=\|\alpha\|$。
    \item
    $T$将一组标准正交基变换成另一组标准正交基。
    \item
    $T$在$V$的任一祖标准正交基下的矩阵是正交矩阵。
  \end{enumerate}
\end{theorem}

\begin{theorem}
  若$T$是正交变换，则$T^{-1}$也是正交变换。
\end{theorem}
